let v1,v2,persist,step=0,prevPersist=null,currentScaling=null;function setup(){createCanvas(800,600),angleMode(DEGREES),textAlign(CENTER,CENTER),textSize(14),persist=createGraphics(width,height),persist.clear()}function draw(){switch(background(10),image(persist,0,0),drawMatrixDisplay(),centerOrigin(),drawAxes(),step){case 0:resetMatrix(),fill(255),noStroke(),text("Click to set the red vector",width/2,25),translate(width/2,height/2);const e=mouseVec();drawVect(e,color(255,100,100));break;case 1:v1.drawWithMatrix(color(255,100,100)),resetMatrix(),fill(255),noStroke(),text("Click to set the blue vector",width/2,25),translate(width/2,height/2);const t=mouseVec();drawVect(t,color(100,150,255));break;case 2:const r=p5.Vector.dist(v2.offset,v1.vec),i=r>7?.05:.15;v2.offset.lerp(v1.vec,i),v1.drawWithMatrix(color(255,100,100)),v2.drawWithMatrix(color(100,150,255)),r<2&&(v2.offset=v1.vec.copy(),step=3);break;case 3:v1.drawWithMatrix(color(255,100,100)),v2.drawWithMatrix(color(100,150,255));const s=v2.tip();push(),fill(255),noStroke(),textSize(16),textAlign(CENTER,BOTTOM),text("place your mouse here",s.x-textWidth("place your mouse here")/2,s.y-10),circle(s.x,s.y,7*-sin(15*frameCount)+7),pop();const o=mouseVec();p5.Vector.dist(o,s)<=5&&(step=4);break;case 4:const c=mouseVec();let a=c.copy();const l=v1.original.x*v2.original.y-v1.original.y*v2.original.x;if(abs(l)>.001){const e=(c.x*v2.original.y-c.y*v2.original.x)/l,t=(v1.original.x*c.y-v1.original.y*c.x)/l;v1.setScale(e),v2.setScale(t),v2.offset=v1.vec.copy(),currentScaling=createVector(e,t)}else{const e=v1.original.copy(),t=e.x*e.x+e.y*e.y;if(t>1e-6){const r=(c.x*e.x+c.y*e.y)/t;v1.setScale(r),v2.setScale(0),v2.offset=v1.vec.copy();const i=p5.Vector.mult(v1.original,r);a=i,currentScaling=createVector(r,0),push(),stroke("orange"),strokeWeight(1),noFill(),line(c.x,c.y,i.x,i.y),pop(),push(),textSize(18),fill("orange"),noStroke(),text("vectors are parallel - we can only move in 1 dimension!",0,0),pop()}else push(),textSize(22),fill("orange"),text("invalid vector, click to reset",0,0),pop()}if(circle(a.x,a.y,5),persist){const e=a.x*("undefined"!=typeof vectScale?vectScale:1)+width/2,t=a.y*("undefined"!=typeof vectScale?vectScale:1)+height/2;persist.push(),persist.stroke(color(150,255,150)),persist.strokeWeight(2),persist.strokeCap(ROUND),persist.strokeJoin(ROUND),prevPersist?persist.line(prevPersist.x,prevPersist.y,e,t):persist.point(e,t),persist.pop(),prevPersist={x:e,y:t}}currentScaling||(currentScaling=null),v1.drawWithScaleAndMatrix(color(255,100,100)),v2.drawWithScaleAndMatrix(color(100,150,255)),fill(255),noStroke(),textSize(16),textAlign(CENTER,CENTER),text("("+c.x.toFixed(0)+", "+(-c.y).toFixed(0)+")",c.x-35,c.y-15),textSize(14),resetMatrix(),fill(255),noStroke(),text("Move mouse to scale vectors. Click to reset.",width/2,25),translate(width/2,height/2)}}function mousePressed(){switch(step){case 0:v1=new Vector(mouseVec()),step=1;break;case 1:v2=new Vector(mouseVec()),step=2;break;case 2:break;case 3:step++;break;default:step=0,v1=v2=void 0,persist&&persist.clear(),prevPersist=null,currentScaling=null}}